<div id=D__ID>
    <div>
        <section>
            <div id=toolbar__ID class="navbar navbar-default">
                    <div id=row_1__ID>
                            <button id=info__ID type=button class='btn btn-secondary' title='Add new' style='display:none'><i class="fa fa-info"></i></button>
                            <button id=new__ID  type=button class='btn btn-secondary' title='Add new'><i class="fa fa-plus"></i></button>
                            <button id=query__ID type=button class="btn btn-secondary" title='Refresh'><i class="fas fa-redo-alt"></i></button>
                    </div>
            </div>
            <div id=table__ID>
                <table id=grid__ID></table>
            </div>
        </section>
        <style>
            #toolbar__ID{
                background-color:#ccc;
                padding:5px 10px;
                margin-bottom:0px;
                overflow:hidden
            }
            #toolbar__ID *{
                margin-right:3px;
            }
            #keyword__ID{
                width: 150px; 
                display:inline-block;
            }
            @media screen and (max-width:768px){
                #toolbar__ID{
                    padding: 3px 0;
                }
                #toolbar__ID div{
                    padding-left:3px;
                }
                #row_1__ID{
                    padding-bottom: 3px;
                    width:100%;
                }
                #keyword__ID{
                    width:auto;
                }
            }
        </style>
    </div>
    <script>
        function F__ID(){
            //-------------------------------------
            VmInclude:__COMPONENT__/g/grid.365r.01.js
            //-------------------------------------
            var fields="\
                    Student Identification Number|Student_x0020_Identification_x00,\
					Have they ever been affiliated with Sydney University|Have_x0020_they_x0020_ever_x0020,\
					If yes please advise their Unikey details|If_x0020_yes_x0020_please_x0020_,\
					Student Title/Salutation|Student_x0020_Title_x002f_Saluta,\
					Student Surname|Student_x0020_Surname,\
					Student First Name|Student_x0020_First_x0020_Name,\
					Student Gender|Student_x0020_Gender,\
					Address|Address,\
					Surburb|Surburb,\
					State|State,\
					Postcode|Postcode,\
					Country|Country,\
					Student Date of Birth|Student_x0020_Date_x0020_of_x002,\
					Email Address (Personal)|Email_x0020_Address_x0020__x0028,\
					Phone Number (Home)|Phone_x0020_Number_x0020__x0028_,\
					Phone Number (Mobile)|Phone_x0020_Number_x0020__x0028_0,\
					Emergency Contact Name|Emergency_x0020_Contact_x0020_Na,\
					Emergency Contact Relationship|Emergency_x0020_Contact_x0020_Re,\
                    Emergency Contact Number (include any area/country codes)|Emergency_x0020_Contact_x0020_Nu,\
					Emergency Contact Additional details if required|Emergency_x0020_Contact_x0020_Ad,\
                    Student Nationality|Student_x0020_Nationality,\
                    Student Passport Number|Student_x0020_Passport_x0020_Num,\
					Visa Type (if applicable)|Visa_x0020_Type_x0020__x0028_if_,\
					Visa Number (if applicable)|Visa_x0020_Number_x0020__x0028_i,\
                    Visa Start Date (if applicable)|Visa_x0020_Start_x0020_Date_x002,\
					Visa Expiry Date (if applicable)|Visa_x0020_Expiry_x0020_Date_x00,\
                    Location|Location,\
					Other please detail|Other_x0020_please_x0020_detail,\
					Monday (Approx. hours)|Monday_x0020__x0028_Approx_x002e,\
					Tuesday (Approx. hours)|Tuesday_x0020__x0028_Approx_x002,\
					Wednesday (Approx. hours)|Wednesday_x0020__x0028_Approx_x0,\
					Thursday (Approx. hours)|Thursday_x0020__x0028_Approx_x00,\
					Friday (Approx. hours)|Friday_x0020__x0028_Approx_x002e,\
                    Degree Type|Degree_x0020_Type,\
					Student Classification|Student_x0020_Classification,\
					Student Status|Student_x0020_Status,\
					Is this the employeeâ€™s first degree|Is_x0020_this_x0020_the_x0020_em,\
                    If no please list previous degrees|If_x0020_no_x0020_please_x0020_l,\
                    Student Undergraduate Degree Name|Student_x0020_Undergraduate_x002,\
                    Student Undergraduate Degree University|Student_x0020_Undergraduate_x0020,\
					Did the Student complete their previous Degree with Woolcock|Did_x0020_the_x0020_Student_x002,\
					Woolcock Group|Woolcock_x0020_Group,\
                    Woolcock Agreement Student Start Date|Woolcock_x0020_Agreement_x0020_S,\
					Woolcock Student Agreement End Date|Woolcock_x0020_Student_x0020_Agr,\
                    Primary Supervisor Name and Title|Primary_x0020_Supervisor_x0020_N,\
                    Main Woolcock Supervisor Name and Title|Main_x0020_Woolcock_x0020_Superv,\
                    Other Woolcock Supervisor Name and Title (if applicable)|Other_x0020_Woolcock_x0020_Super,\
                    Post Graduate Coordinator Name and Title|Post_x0020_Graduate_x0020_Coordi,\
                    Other Supervisors Name and Title (if applicable)|Other_x0020_Supervisors_x0020_Na,\
                    Enrolled University|Enrolled_x0020_University,\
                    Other please list|Other_x0020_please_x0020_list,\
                    Enrollment Type|Enrollment_x0020_Type,\
                    Degree Name|Degree_x0020_Name,\
                    Faculty (if applicable)|Faculty_x0020__x0028_if_x0020_ap,\
					School (if applicable)|School_x0020__x0028_if_x0020_app,\
					Discipline (if applicable)|Discipline_x0020__x0028_if_x0020,\
                    University Attendance Status|University_x0020_Attendance_x002,\
					Year commenced current degree|Year_x0020_commenced_x0020_curre,\
					Year expect to complete current degree|Year_x0020_expect_x0020_to_x0020,\
                    Scholarship|Scholarship,\
                    If yes please provide the name of the Scholarship|If_x0020_yes_x0020_please_x0020_0,\
					Thesis Details|Thesis_x0020_Details,\
					Student Other Information (E.g. Cotutelle)|Student_x0020_Other_x0020_Inform,\
					Main Location|Main_x0020_Location,\
                    The position requires a building access/swipe card|The_x0020_position_x0020_require,\
                    The position requires a desk|The_x0020_position_x0020_require0,\
					The position requires computer access|The_x0020_position_x0020_require1,\
                    The position requires Level 3 Lab access|The_x0020_position_x0020_require2,\
                    Will this position come into contact with patients/research participants|Will_x0020_this_x0020_position_x,\
					Additional Student Information|Additional_x0020_Student_x0020_I\
				";
            var fields_hide="\
                ";
            m.fields="_Form,"+fields+",Submit_date,Submitted_by,_Delete";
            //-------------------------------------
            m.set_req=function(){
                m.endpoint=m.Table+"/items?$expand=Author&$select=*,Author/FirstName,Author/LastName";
                m.endpoint=m.Table+"/items?$expand=Author&$select=*,Author/UserName,Author/FirstName,Author/LastName&$filter=Author/UserName eq '"+$vm.user_name_365+"' ";
                m.endpoint_d=m.Table+"/items";
            }
            //-------------------------------------
            m.data_process=function(res){
                $('#vm_data_loader').hide();
                m.records=[];
                for(var i=0;i<res.value.length;i++){
                    var fs=res.value[i];
                    var Data={}
                    //var f_ids=(fields+fields_hide).split(',')
                    var f_ids=(fields).split(',')
                    for(k in f_ids){
                        var id=f_ids[k].split('|').pop().trim();
                        Data[id]=fs[id];
                    }
                    m.records.push({
                        "_id":res.value[i]['ID'],
                        "Submit_date":res.value[i]['Created'],
                        "Submitted_by":res.value[i].Author.FirstName+" "+res.value[i].Author.LastName,
                        Data:Data
                    })
                    console.log(m.records[i].Data)
                }
                m.render();
            }
            //-------------------------------------
            m.request_data=function(){
                $('#vm_data_loader').show();
                $vm.m365_msal.acquireTokenSilent($vm.m365_scope_sharepoint).then(function (tokenResponse) {
                    m.ajax(m.endpoint,tokenResponse,function(data){
                        m.data_process(data);
                    })
                }).catch(function (error) {
                    $('#vm_data_loader').hide();
                    console.log(error);
                    $vm.alert("You haven't signed in, or your previous session has expired.")
                });
            }
            //-------------------------------------
            m.delete=function(rid){
                $vm.m365_msal.acquireTokenSilent($vm.m365_scope_sharepoint).then(function (tokenResponse) {
                    var mt1=new Date().getTime();
                    var xmlHttp = new XMLHttpRequest();
                    xmlHttp.onreadystatechange = function () {
                        if (this.readyState == 4 && (this.status == 204 || this.status == 200)){
                            var mt2=new Date().getTime();
                            var tt_all=mt2-mt1;
                            m.request_data();
                        }
                    }
                    xmlHttp.open("DELETE", m.endpoint_d+"("+rid+")", true); // true for asynchronous
                    xmlHttp.setRequestHeader('Authorization', 'Bearer ' + tokenResponse.accessToken);
                    xmlHttp.setRequestHeader("Accept", "application/json");  
                    xmlHttp.setRequestHeader("Content-Type", "application/json; charset=utf-8");  
                    xmlHttp.setRequestHeader("IF-MATCH", "*");  
                    xmlHttp.send();
                }).catch(function (error) {
                    console.log(error);
                });
            };
            //-------------------------------


        }
    </script>
    <style>
        VmInclude:__COMPONENT__/g/grid.01.css
    </style>
</div>
